From news@gmane.org Tue Mar 04 03:33:20 2003
From: Petr Baudis <pasky@ucw.cz>
Subject: Re: [PATCH] Colorized git log
Date: Fri, 22 Apr 2005 02:54:52 +0200
Lines: 59
Message-ID: <20050422005452.GZ7443@pasky.ji.cz>
References: <3536.10.10.10.24.1114117965.squirrel@linux1> <20050421224229.GR7443@pasky.ji.cz> <f0796bb7050421174647943f0c@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Cc: GIT Mailing Lists <git@vger.kernel.org>
X-From: git-owner@vger.kernel.org Fri Apr 22 02:54:05 2005
Return-path: <git-owner@vger.kernel.org>
Received: from vger.kernel.org ([12.107.209.244])
	by ciao.gmane.org with esmtp (Exim 4.43)
	id 1DOmQm-0004la-Mn
	for gcvg-git@gmane.org; Fri, 22 Apr 2005 02:54:04 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261900AbVDVA56 (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Thu, 21 Apr 2005 20:57:58 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261899AbVDVA55
	(ORCPT <rfc822;git-outgoing>); Thu, 21 Apr 2005 20:57:57 -0400
Received: from w241.dkm.cz ([62.24.88.241]:56716 "HELO machine.sinus.cz")
	by vger.kernel.org with SMTP id S261910AbVDVAyz (ORCPT
	<rfc822;git@vger.kernel.org>); Thu, 21 Apr 2005 20:54:55 -0400
Received: (qmail 23865 invoked by uid 2001); 22 Apr 2005 00:54:52 -0000
To: Daniel Serpell <daniel.serpell@gmail.com>
Content-Disposition: inline
In-Reply-To: <f0796bb7050421174647943f0c@mail.gmail.com>
User-Agent: Mutt/1.4i
X-message-flag: Outlook : A program to spread viri, but it can do mail too.
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Status: RO

Dear diary, on Fri, Apr 22, 2005 at 02:46:19AM CEST, I got a letter
where Daniel Serpell <daniel.serpell@gmail.com> told me that...
> Hi!

Hi,

> On 4/21/05, Petr Baudis <pasky@ucw.cz> wrote:
> > 
> > I made git log colorized if you pass it -c in current git-pasky. 
> > 
> 
> This has two problems, solved in two patches:

could you please sign them off?

> * A space is added in front of  header lines when you use color.

Oh, good catch, thanks.

> * It does not  work in my (Debian) xterm. This is because here 
>   "setterm" only works with TERM=linux.

Duh. And they say "Where possible terminfo is consulted to find the
string to use." in their manual page. :/

> gitlog.sh: 6d24d857fb6c2f7e810954adaca1990599906f07
> --- a/gitlog.sh
> +++ b/gitlog.sh
> @@ -11,11 +11,11 @@
>  
>  if [ "$1" = "-c" ]; then
>  	shift
> -	colheader=$(setterm -foreground green)
> -	colauthor=$(setterm -foreground cyan)
> -	colcommitter=$(setterm -foreground magenta)
> -	colsignoff=$(setterm -foreground yellow)
> -	coldefault=$(setterm -foreground default)
> +	colheader="$(tput setaf 2)"
> +	colauthor="$(tput setaf 6)"
> +	colcommitter="$(tput setaf 5)"
> +	colsignoff="$(tput setaf 3)"
> +	coldefault="$(tput op)"
>  else
>  	colheader=
>  	colauthor=

Please at least stick the colors in comments after the assignment.
Not everyone knows ANSI color codes off-hand (the last thing I've
memorized were BIOS color codes in the distant DOS days).

-- 
				Petr "Pasky" Baudis
Stuff: http://pasky.or.cz/
C++: an octopus made by nailing extra legs onto a dog. -- Steve Taylor
-
To unsubscribe from this list: send the line "unsubscribe git" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  http://vger.kernel.org/majordomo-info.html



From news@gmane.org Tue Mar 04 03:33:20 2003
From: Daniel Serpell <daniel.serpell@gmail.com>
Subject: Re: [PATCH] Colorized git log
Date: Thu, 21 Apr 2005 21:04:16 -0400
Lines: 81
Message-ID: <f0796bb7050421180433eeeb8@mail.gmail.com>
References: <3536.10.10.10.24.1114117965.squirrel@linux1>
	 <20050421224229.GR7443@pasky.ji.cz>
	 <f0796bb7050421174647943f0c@mail.gmail.com>
	 <20050422005452.GZ7443@pasky.ji.cz>
Reply-To: Daniel Serpell <daniel.serpell@gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7BIT
Cc: Petr Baudis <pasky@ucw.cz>
X-From: git-owner@vger.kernel.org Fri Apr 22 03:04:04 2005
Return-path: <git-owner@vger.kernel.org>
Received: from vger.kernel.org ([12.107.209.244])
	by ciao.gmane.org with esmtp (Exim 4.43)
	id 1DOmZc-0005Wf-9f
	for gcvg-git@gmane.org; Fri, 22 Apr 2005 03:03:12 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261902AbVDVBEZ (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Thu, 21 Apr 2005 21:04:25 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261905AbVDVBEZ
	(ORCPT <rfc822;git-outgoing>); Thu, 21 Apr 2005 21:04:25 -0400
Received: from wproxy.gmail.com ([64.233.184.193]:49519 "EHLO wproxy.gmail.com")
	by vger.kernel.org with ESMTP id S261902AbVDVBER convert rfc822-to-8bit
	(ORCPT <rfc822;git@vger.kernel.org>);
	Thu, 21 Apr 2005 21:04:17 -0400
Received: by wproxy.gmail.com with SMTP id 68so717826wri
        for <git@vger.kernel.org>; Thu, 21 Apr 2005 18:04:16 -0700 (PDT)
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
        s=beta; d=gmail.com;
        h=received:message-id:date:from:reply-to:to:subject:cc:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=Y7PIwYKKQ+8MCeYrn6/xVMN+HRjBEZbMM/PMZDFP5Ohy6jIVr2IAoJAgY6kuOucmIlcvnYGkPWo8zBlw86KBXKANjg8whVyJWbbszKoivHUqa/6IgxX/feLh+sRQ74VmRqF67yvQ/jvfMHhxvLFf3HE8I2WmRbU1acUqDi79p7Q=
Received: by 10.54.15.76 with SMTP id 76mr197439wro;
        Thu, 21 Apr 2005 18:04:16 -0700 (PDT)
Received: by 10.54.18.62 with HTTP; Thu, 21 Apr 2005 18:04:16 -0700 (PDT)
To: GIT Mailing Lists <git@vger.kernel.org>
In-Reply-To: <20050422005452.GZ7443@pasky.ji.cz>
Content-Disposition: inline
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Status: RO

Hi!

On 4/21/05, Petr Baudis <pasky@ucw.cz> wrote:
> Dear diary, on Fri, Apr 22, 2005 at 02:46:19AM CEST, I got a letter
> where Daniel Serpell <daniel.serpell@gmail.com> told me that...
> >
> > This has two problems, solved in two patches:
> 
> could you please sign them off?

Ok, here are, resent (I suppose it's ok tho put all in one e-mail),
and with the comments added.

--------------
Strip space in front of colorized header lines.

Signed-off-by:  Daniel Serpell <daniel.serpell@gmail.com>

+++ b/gitlog.sh
@@ -27,7 +27,7 @@ fi
 base=$(gitXnormid.sh -c $1) || exit 1
 
 rev-tree $base | sort -rn | while read time commit parents; do
-	echo $colheader commit ${commit%:*} $coldefault;
+	echo $colheader""commit ${commit%:*} $coldefault;
 	cat-file commit $commit | \
 		while read key rest; do
 			case "$key" in
@@ -43,10 +43,10 @@ rev-tree $base | sort -rn | while read t
 				dtz=${tz/+/+ }; dtz=${dtz/-/- }
 				pdate="$(date -Rud "1970-01-01 UTC + $sec sec $dtz" 2>/dev/null)"
 				if [ "$pdate" ]; then
-					echo -n $color $key $rest | sed "s/>.*/> ${pdate/+0000/$tz}/"
+					echo -n $color$key $rest | sed "s/>.*/> ${pdate/+0000/$tz}/"
 					echo $coldefault
 				else
-					echo $color $key $rest $coldefault
+					echo $color$key $rest $coldefault
 				fi
 				;;
 			"")
@@ -56,7 +56,7 @@ rev-tree $base | sort -rn | while read t
 				'
 				;;
 			*)
-				echo $colheader $key $rest $coldefault
+				echo $colheader$key $rest $coldefault
 				;;
 			esac
 
--------------
Uses tput instead of setterm to set colors, seems to work with more
terminals.

Signed-off-by:  Daniel Serpell <daniel.serpell@gmail.com>

gitlog.sh: 6d24d857fb6c2f7e810954adaca1990599906f07
--- a/gitlog.sh
+++ b/gitlog.sh
@@ -11,11 +11,11 @@
 
 if [ "$1" = "-c" ]; then
 	shift
-	colheader=$(setterm -foreground green)
-	colauthor=$(setterm -foreground cyan)
-	colcommitter=$(setterm -foreground magenta)
-	colsignoff=$(setterm -foreground yellow)
-	coldefault=$(setterm -foreground default)
+	colheader="$(tput setaf 2)" # Green, see terminfo(5), "Color Handling"
+	colauthor="$(tput setaf 6)" # Cyan
+	colcommitter="$(tput setaf 5)" # Magenta
+	colsignoff="$(tput setaf 3)" # Yellow
+	coldefault="$(tput op)" # Restore default
 else
 	colheader=
 	colauthor=
-
To unsubscribe from this list: send the line "unsubscribe git" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  http://vger.kernel.org/majordomo-info.html



From news@gmane.org Tue Mar 04 03:33:20 2003
From: Steven Cole <elenstev@mesatop.com>
Subject: Re: [PATCH] Colorized git log
Date: Thu, 21 Apr 2005 19:04:18 -0600
Lines: 43
Message-ID: <200504211904.18283.elenstev@mesatop.com>
References: <3536.10.10.10.24.1114117965.squirrel@linux1> <f0796bb7050421174647943f0c@mail.gmail.com> <20050422005452.GZ7443@pasky.ji.cz>
Mime-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Cc: Daniel Serpell <daniel.serpell@gmail.com>,
	GIT Mailing Lists <git@vger.kernel.org>
X-From: git-owner@vger.kernel.org Fri Apr 22 03:04:32 2005
Return-path: <git-owner@vger.kernel.org>
Received: from vger.kernel.org ([12.107.209.244])
	by ciao.gmane.org with esmtp (Exim 4.43)
	id 1DOmaU-0005b7-6Y
	for gcvg-git@gmane.org; Fri, 22 Apr 2005 03:04:06 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261899AbVDVBIc (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Thu, 21 Apr 2005 21:08:32 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261905AbVDVBIc
	(ORCPT <rfc822;git-outgoing>); Thu, 21 Apr 2005 21:08:32 -0400
Received: from nacho.zianet.com ([216.234.192.105]:63502 "HELO
	nacho.zianet.com") by vger.kernel.org with SMTP id S261899AbVDVBI1
	(ORCPT <rfc822;git@vger.kernel.org>);
	Thu, 21 Apr 2005 21:08:27 -0400
Received: (qmail 5627 invoked from network); 22 Apr 2005 01:08:22 -0000
Received: from 216-31-65-209.zianet.com (216.31.65.209)
  by 0 with SMTP; 22 Apr 2005 01:08:22 -0000
To: Petr Baudis <pasky@ucw.cz>
User-Agent: KMail/1.6.1
In-Reply-To: <20050422005452.GZ7443@pasky.ji.cz>
Content-Disposition: inline
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Status: RO

On Thursday 21 April 2005 06:54 pm, Petr Baudis wrote:

> Duh. And they say "Where possible terminfo is consulted to find the
> string to use." in their manual page. :/
> 
> > gitlog.sh: 6d24d857fb6c2f7e810954adaca1990599906f07
> > --- a/gitlog.sh
> > +++ b/gitlog.sh
> > @@ -11,11 +11,11 @@
> >  
> >  if [ "$1" = "-c" ]; then
> >  	shift
> > -	colheader=$(setterm -foreground green)
> > -	colauthor=$(setterm -foreground cyan)
> > -	colcommitter=$(setterm -foreground magenta)
> > -	colsignoff=$(setterm -foreground yellow)
> > -	coldefault=$(setterm -foreground default)
> > +	colheader="$(tput setaf 2)"
> > +	colauthor="$(tput setaf 6)"
> > +	colcommitter="$(tput setaf 5)"
> > +	colsignoff="$(tput setaf 3)"
> > +	coldefault="$(tput op)"
> >  else
> >  	colheader=
> >  	colauthor=
> 
> Please at least stick the colors in comments after the assignment.
> Not everyone knows ANSI color codes off-hand (the last thing I've
> memorized were BIOS color codes in the distant DOS days).
> 

I like the color idea, but since many people have their own idea
of what colors are appropriate, etc (I use a dark background, and
the magenta is painful), perhaps we could have a LOG_COLORS
file, similar in concept (but more readable) to the /etc/DIR_COLORS
file.  Great work !

Steven
-
To unsubscribe from this list: send the line "unsubscribe git" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  http://vger.kernel.org/majordomo-info.html



From news@gmane.org Tue Mar 04 03:33:20 2003
From: Pavel Roskin <proski@gnu.org>
Subject: [PATCH] Colored log on any ANSI capable terminal
Date: Thu, 21 Apr 2005 21:42:17 -0400
Lines: 41
Message-ID: <1114134137.12771.7.camel@dv>
Mime-Version: 1.0
Content-Type: text/plain
Content-Transfer-Encoding: 7bit
X-From: git-owner@vger.kernel.org Fri Apr 22 03:38:06 2005
Return-path: <git-owner@vger.kernel.org>
Received: from vger.kernel.org ([12.107.209.244])
	by ciao.gmane.org with esmtp (Exim 4.43)
	id 1DOn7J-0000Fr-5U
	for gcvg-git@gmane.org; Fri, 22 Apr 2005 03:38:01 +0200
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S261912AbVDVBmY (ORCPT <rfc822;gcvg-git@m.gmane.org>);
	Thu, 21 Apr 2005 21:42:24 -0400
Received: (majordomo@vger.kernel.org) by vger.kernel.org id S261913AbVDVBmY
	(ORCPT <rfc822;git-outgoing>); Thu, 21 Apr 2005 21:42:24 -0400
Received: from h-64-105-159-118.phlapafg.covad.net ([64.105.159.118]:53638
	"EHLO localhost.localdomain") by vger.kernel.org with ESMTP
	id S261912AbVDVBmT (ORCPT <rfc822;git@vger.kernel.org>);
	Thu, 21 Apr 2005 21:42:19 -0400
Received: by localhost.localdomain (Postfix, from userid 500)
	id 3FF73EFF85; Thu, 21 Apr 2005 21:42:17 -0400 (EDT)
To: git <git@vger.kernel.org>
X-Mailer: Evolution 2.2.1.1 
Sender: git-owner@vger.kernel.org
Precedence: bulk
X-Mailing-List: git@vger.kernel.org
Status: RO

Hello!

setterm only works on Linux terminal.  It should be safe to use raw ANSI
sequences -they work on most terminals, including xterm.  Nobody forces
you to use the "-c" option to "git log" on those stone-age terminals
that neither support nor ignore ANSI color codes.

I'm aware of $'...' but it may not work in bash 1.x.

Signed-off-by: Pavel Roskin <proski@gnu.org>

--- a/gitlog.sh
+++ b/gitlog.sh
@@ -12,11 +12,11 @@
 
 if [ "$1" = "-c" ]; then
 	shift
-	colheader=$(setterm -foreground green)
-	colauthor=$(setterm -foreground cyan)
-	colcommitter=$(setterm -foreground magenta)
-	colsignoff=$(setterm -foreground yellow)
-	coldefault=$(setterm -foreground default)
+	colheader=$(echo -ne '\e[32m')
+	colauthor=$(echo -ne '\e[36m')
+	colcommitter=$(echo -ne '\e[35m')
+	colsignoff=$(echo -ne '\e[33m')
+	coldefault=$(echo -ne '\e[39m')
 else
 	colheader=
 	colauthor=


-- 
Regards,
Pavel Roskin

-
To unsubscribe from this list: send the line "unsubscribe git" in
the body of a message to majordomo@vger.kernel.org
More majordomo info at  http://vger.kernel.org/majordomo-info.html



